name: Naming Convention Validation

on:
  pull_request:
    branches: [ main, develop ]
  push:
    branches: [ main, develop ]

jobs:
  naming-validation:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
        cache: 'npm'
        
    - name: Install dependencies
      run: npm ci
      
    - name: Validate naming conventions
      run: |
        echo "🏷️ Validating naming conventions..."
        npm run naming:quick src/
        
    - name: Generate naming report
      if: failure()
      run: |
        echo "📊 Generating detailed naming analysis..."
        npm run naming:analyze src/ || true
        npm run naming:validate src/ || true
        
    - name: Comment PR with naming issues
      if: failure() && github.event_name == 'pull_request'
      uses: actions/github-script@v7
      with:
        script: |
          const { execSync } = require('child_process');
          
          try {
            // Get naming analysis
            const analysis = execSync('npm run naming:analyze src/', { encoding: 'utf8' });
            
            const comment = `## 🏷️ Naming Convention Issues Found
            
            The automated naming validation has detected issues that need to be addressed:
            
            \`\`\`
            ${analysis}
            \`\`\`
            
            ### 🔧 How to Fix
            
            1. **Analyze issues**: \`npm run naming:analyze src/\`
            2. **Generate fix script**: \`npm run naming:fix src/ --dry-run\`
            3. **Apply fixes carefully**: Review and apply suggested changes
            4. **Validate**: \`npm run naming:validate src/\`
            
            ### 📚 Reference
            See [Naming Convention Standards](./docs/NAMING_CONVENTIONS.md) for detailed guidelines.
            
            ---
            *This check enforces consistent kebab-case file naming and TypeScript naming conventions per the Google Style Guide.*`;
            
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: comment
            });
          } catch (error) {
            console.log('Could not generate naming analysis comment:', error.message);
          }